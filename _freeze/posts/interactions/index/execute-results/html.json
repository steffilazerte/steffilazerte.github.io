{
  "hash": "22ddbed3c2704052aff4f9b242eea865",
  "result": {
    "markdown": "---\ntitle: \"Interpreting interactions\"\ndate: \"2023-06-06\"\ncategories: [stats, models, interactions, predictions, R]\nexecute:\n  message: false\n  warning: false\nfig-width: 10\n---\n\n\n[Creating](../basic-models) models and [checking](../dharma) their [assumptions](../diagnostics-lm)\nare the first steps to running an analysis, but once you have a beautiful,\nvalid model, what next?\n\nInterpreting models can be tricky as some results aren't intuitive (i.e. often\ninteractions, or non-Gaussian models), and to get the most out of your model, \nyou'll want to understand both what parameters are important (or significant),\nas well as *how* they are important (effects size and direction). \n\nYou may also want to run a post-hoc analysis to dive deeper into the effects of \ncategorical predictors.\n\nHere we'll take a quick look at interactions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)  # penguins data\nlibrary(car)             # Type 3 anova\nlibrary(marginaleffects) # Exploring interactions\nlibrary(ggplot2)\n```\n:::\n\n\n\n### Interpreting Interactions\n\nLet's see if there is an interaction between flipper length and bill depth on bill length.\nThis may not be a terribly sensible example (and note that we're skipping the all important\nstep of checking our model!), but it should hopefully illustrate these tools.\n\nFirst let's create a linear model. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- lm(bill_length_mm ~ flipper_length_mm * bill_depth_mm, data = penguins)\n```\n:::\n\n\nWe can explore the results by looking at the `summary()` table\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = bill_length_mm ~ flipper_length_mm * bill_depth_mm, \n    data = penguins)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-10.6952  -2.5439  -0.2036   2.4788  19.9132 \n\nCoefficients:\n                                Estimate Std. Error t value Pr(>|t|)  \n(Intercept)                     72.14404   49.77162   1.450   0.1481  \nflipper_length_mm               -0.18476    0.24265  -0.761   0.4469  \nbill_depth_mm                   -5.31449    2.93076  -1.813   0.0707 .\nflipper_length_mm:bill_depth_mm  0.02917    0.01439   2.027   0.0434 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.991 on 338 degrees of freedom\n  (2 observations deleted due to missingness)\nMultiple R-squared:  0.4703,\tAdjusted R-squared:  0.4656 \nF-statistic:   100 on 3 and 338 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nOr with an `Anova()` table (here, from the car package, so we can get type III)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnova(m, type = \"III\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnova Table (Type III tests)\n\nResponse: bill_length_mm\n                                Sum Sq  Df F value  Pr(>F)  \n(Intercept)                       33.5   1  2.1011 0.14812  \nflipper_length_mm                  9.2   1  0.5798 0.44694  \nbill_depth_mm                     52.4   1  3.2882 0.07067 .\nflipper_length_mm:bill_depth_mm   65.5   1  4.1103 0.04341 *\nResiduals                       5384.2 338                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nOkay, in our standard interpretation, we would say that yes, there is an interaction \n(p = 0.043). \n\nWith continuous variables, the summary table is often a bit more informative, \nas we can interpret the estimates. In this case, we can interpret the interaction\nas: for every 1 mm increase in flipper length, the effect of a\n1 mm increase on bill depth increases by 0.029.\n\nHmm, not incredibly intuitive!\n\nThe marginalmeans package can be used to explore models with interactions via \n\"conditional marginal effects\" and predictions\n\n#### Conditional marginal effects\n\nThese are really nice way of visualizing the verbal interpretation we made above.\n\nWe'll use the `plot_slopes()` function to plot the effect of one variable on the slope of the other (i.e. an interaction!).\n\nHere, we look at the effect of bill depth on the slope of flipper length (i.e.\nthe effect of flipper length on our response, bill length).\n\nThe Y-axis represents the slope of the effect of flipper length on bill depth.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_slopes(m, variables = \"flipper_length_mm\", condition = \"bill_depth_mm\") +\n  theme_minimal() +\n  labs(y = \"Slope of flipper length\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\nThis figure is a visualization of our interaction parameter, but also puts things into \nthe proper context and includes confidence intervals!\n\nHere we see that a) the slope is always positive, b) becomes stronger for increasing bill depth.\n\n### Plotting predictions\n\nWe can plot the predictions to get a visual of this interaction.\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_predictions(m, condition = list(\"flipper_length_mm\", \"bill_depth_mm\"),\n                 point = 0.5)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n\n\nHere we can see the various lines (slopes) representing the effect of flipper length on\nbill length across different bill depths. We see that the effect (slope) increases \nas bill depth increases (compare the line with bill depth at 21.5 to the one with\nbill depth at 13.1). This is another visual representation of what we stated above, \nwith additional context. In addition to seeing that all the slopes are positive, \nand the changes make them stronger, we see this in relation to the original data.\n\nI find this kind of plot useful for sharing your results as it shows the raw data\nalong with the model results and a clear explanation of what that interaction \nreally means.\n\n### Conclusions\n\nInterpreting interactions can be much simpler with visual aids, and it's a \ngood idea to use these figures not only for your benefit but for the benefit of\nanyone you're sharing your work with. \n\nYou can make these figures by hand, but using marginalmeans will make it much \neasier (if slightly less customizable).\n\n### Further Reading\n\n- https://vincentarelbundock.github.io/marginaleffects/\n- https://www.andrewheiss.com/blog/2022/05/20/marginalia/#tldr-overall-summary-of-all-these-marginal-effects-approaches\n\n### Session Info\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::session_info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.3.1 (2023-06-16)\n os       Ubuntu 22.04.3 LTS\n system   x86_64, linux-gnu\n ui       X11\n language en_CA:en\n collate  en_CA.UTF-8\n ctype    en_CA.UTF-8\n tz       America/Winnipeg\n date     2023-09-04\n pandoc   3.1.1 @ /usr/lib/rstudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package         * version date (UTC) lib source\n abind             1.4-5   2016-07-21 [1] CRAN (R 4.3.0)\n backports         1.4.1   2021-12-13 [1] CRAN (R 4.3.0)\n cachem            1.0.8   2023-05-01 [1] CRAN (R 4.3.0)\n callr             3.7.3   2022-11-02 [1] CRAN (R 4.3.0)\n car             * 3.1-2   2023-03-30 [1] CRAN (R 4.3.0)\n carData         * 3.0-5   2022-01-06 [1] CRAN (R 4.3.0)\n checkmate         2.2.0   2023-04-27 [1] CRAN (R 4.3.0)\n cli               3.6.1   2023-03-23 [1] CRAN (R 4.3.0)\n colorspace        2.1-0   2023-01-23 [1] CRAN (R 4.3.0)\n crayon            1.5.2   2022-09-29 [1] CRAN (R 4.3.0)\n data.table        1.14.8  2023-02-17 [1] CRAN (R 4.3.0)\n devtools          2.4.5   2022-10-11 [1] CRAN (R 4.3.0)\n digest            0.6.31  2022-12-11 [1] CRAN (R 4.3.0)\n dplyr             1.1.2   2023-04-20 [1] CRAN (R 4.3.0)\n ellipsis          0.3.2   2021-04-29 [1] CRAN (R 4.3.0)\n evaluate          0.20    2023-01-17 [1] CRAN (R 4.3.0)\n fansi             1.0.4   2023-01-22 [1] CRAN (R 4.3.0)\n farver            2.1.1   2022-07-06 [1] CRAN (R 4.3.0)\n fastmap           1.1.1   2023-02-24 [1] CRAN (R 4.3.0)\n fs                1.6.2   2023-04-25 [1] CRAN (R 4.3.0)\n generics          0.1.3   2022-07-05 [1] CRAN (R 4.3.0)\n ggplot2         * 3.4.2   2023-04-03 [1] CRAN (R 4.3.0)\n glue              1.6.2   2022-02-24 [1] CRAN (R 4.3.0)\n gtable            0.3.3   2023-03-21 [1] CRAN (R 4.3.0)\n htmltools         0.5.5   2023-03-23 [1] CRAN (R 4.3.0)\n htmlwidgets       1.6.2   2023-03-17 [1] CRAN (R 4.3.0)\n httpuv            1.6.9   2023-02-14 [1] CRAN (R 4.3.0)\n insight           0.19.2  2023-05-23 [1] CRAN (R 4.3.0)\n jsonlite          1.8.4   2022-12-06 [1] CRAN (R 4.3.0)\n knitr             1.42    2023-01-25 [1] CRAN (R 4.3.0)\n labeling          0.4.2   2020-10-20 [1] CRAN (R 4.3.0)\n later             1.3.0   2021-08-18 [1] CRAN (R 4.3.0)\n lifecycle         1.0.3   2022-10-07 [1] CRAN (R 4.3.0)\n magrittr          2.0.3   2022-03-30 [1] CRAN (R 4.3.0)\n marginaleffects * 0.12.0  2023-05-20 [1] CRAN (R 4.3.0)\n memoise           2.0.1   2021-11-26 [1] CRAN (R 4.3.0)\n mime              0.12    2021-09-28 [1] CRAN (R 4.3.0)\n miniUI            0.1.1.1 2018-05-18 [1] CRAN (R 4.3.0)\n munsell           0.5.0   2018-06-12 [1] CRAN (R 4.3.0)\n palmerpenguins  * 0.1.1   2022-08-15 [1] CRAN (R 4.3.0)\n pillar            1.9.0   2023-03-22 [1] CRAN (R 4.3.0)\n pkgbuild          1.4.0   2022-11-27 [1] CRAN (R 4.3.0)\n pkgconfig         2.0.3   2019-09-22 [1] CRAN (R 4.3.0)\n pkgload           1.3.2   2022-11-16 [1] CRAN (R 4.3.0)\n prettyunits       1.1.1   2020-01-24 [1] CRAN (R 4.3.0)\n processx          3.8.1   2023-04-18 [1] CRAN (R 4.3.0)\n profvis           0.3.7   2020-11-02 [1] CRAN (R 4.3.0)\n promises          1.2.0.1 2021-02-11 [1] CRAN (R 4.3.0)\n ps                1.7.5   2023-04-18 [1] CRAN (R 4.3.0)\n purrr             1.0.1   2023-01-10 [1] CRAN (R 4.3.0)\n R6                2.5.1   2021-08-19 [1] CRAN (R 4.3.0)\n Rcpp              1.0.10  2023-01-22 [1] CRAN (R 4.3.0)\n remotes           2.4.2   2021-11-30 [1] CRAN (R 4.3.0)\n rlang             1.1.1   2023-04-28 [1] CRAN (R 4.3.0)\n rmarkdown         2.21    2023-03-26 [1] CRAN (R 4.3.0)\n rstudioapi        0.14    2022-08-22 [1] CRAN (R 4.3.0)\n scales            1.2.1   2022-08-20 [1] CRAN (R 4.3.0)\n sessioninfo       1.2.2   2021-12-06 [1] CRAN (R 4.3.0)\n shiny             1.7.4   2022-12-15 [1] CRAN (R 4.3.0)\n stringi           1.7.12  2023-01-11 [1] CRAN (R 4.3.0)\n stringr           1.5.0   2022-12-02 [1] CRAN (R 4.3.0)\n tibble            3.2.1   2023-03-20 [1] CRAN (R 4.3.0)\n tidyselect        1.2.0   2022-10-10 [1] CRAN (R 4.3.0)\n urlchecker        1.0.1   2021-11-30 [1] CRAN (R 4.3.0)\n usethis           2.2.0   2023-06-06 [1] CRAN (R 4.3.0)\n utf8              1.2.3   2023-01-31 [1] CRAN (R 4.3.0)\n vctrs             0.6.2   2023-04-19 [1] CRAN (R 4.3.0)\n withr             2.5.0   2022-03-03 [1] CRAN (R 4.3.0)\n xfun              0.39    2023-04-20 [1] CRAN (R 4.3.0)\n xtable            1.8-4   2019-04-21 [1] CRAN (R 4.3.0)\n yaml              2.3.7   2023-01-23 [1] CRAN (R 4.3.0)\n\n [1] /home/steffi/R/x86_64-pc-linux-gnu-library/4.3\n [2] /usr/local/lib/R/site-library\n [3] /usr/lib/R/site-library\n [4] /usr/lib/R/library\n\n──────────────────────────────────────────────────────────────────────────────\n```\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}