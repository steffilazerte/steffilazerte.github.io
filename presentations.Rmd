---
title: "Presentations and Documents"
---


```{r, message = FALSE, echo = FALSE, results = "asis"}
library(gh)
library(jsonlite)
library(tidyverse)
library(glue)
g <- gh("/repos/steffilazerte/Presentations/contents/")

g2 <- tibble(name = map_chr(g, "name"),
             url = map_chr(g, "html_url")) %>%
  mutate(date = str_extract(name, "[0-9]{4}-[0-9]{2}")) %>%
  filter(!is.na(date)) %>%
  mutate(pres = map(name, ~gh("/repos/steffilazerte/Presentations/contents/{pres}", pres = .)),
         pres = map(pres, ~tibble(file_name = map_chr(., "name"), 
                                  file_url = map_chr(., "html_url")))) %>%
  unnest(pres)

filter(g2, str_detect(file_name, ".(pdf|html|Rmd)$"),) %>%
  mutate(type = str_extract(file_name, "(pdf|html|Rmd)$"),
         file_name = str_remove(file_name, ".(pdf|html|Rmd)$")) %>%
  filter(!file_name %in% c("script")) %>%
  group_by(name, date, url, file_name) %>%
  mutate(
    links = case_when(type == "Rmd" ~ glue("[{type}]({file_url})"),
                      TRUE ~ 
                        glue("[{type}](https://steffilazerte.ca/Presentations/{name}/{file_name[1]}.{type})"))) %>%
  summarize(links = glue_collapse(links, sep = " | "), .groups = "drop_last") %>%
  mutate(files = glue("- {file_name} ({links})\n")) %>%
  summarize(files = glue_collapse(files, sep = "\n"), .groups = "drop_last") %>%
  summarize(name = glue("{name} ([GitHub]({url}))"), 
            entry = glue("\n\n**{name}**\n\n{files}\n\n", trim = FALSE),
            .groups = "drop") %>%
  arrange(desc(date)) %>%
  pull(entry) %>%
  cat()
```